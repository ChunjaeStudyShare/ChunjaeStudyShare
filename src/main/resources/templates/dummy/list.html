<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Dummy List</title>
</head>
<body>
    <h1>나의 학습 리스트</h1>
    
    <!-- 검색 폼 -->
    <form th:action="@{/dummy/getList}" method="get">
        <div>
            <label>기간 검색:</label>
            <input type="date" name="startDate" th:value="${response?.startDate}">
            ~
            <input type="date" name="endDate" th:value="${response?.endDate}">
        </div>
        
        <div>
            <select name="searchField">
                <option value="">검색 필드 선택</option>
                <option value="title" th:selected="${response?.searchField == 'title'}">제목</option>
                <option value="content" th:selected="${response?.searchField == 'content'}">내용</option>
                <option value="all" th:selected="${response?.searchField == 'all'}">전체</option>
            </select>
            
            <input type="text" name="searchKeyword" th:value="${response?.searchKeyword}" placeholder="검색어를 입력하세요">
            <button type="submit">검색</button>
        </div>
        
        <!-- 정렬 옵션 -->
        <input type="hidden" name="sortField" th:value="${response?.sortField}">
        <input type="hidden" name="sortDirection" th:value="${response?.sortDirection}">
        <input type="hidden" name="page" th:value="${response?.currentPage}">
        <input type="hidden" name="size" th:value="${response?.size}">
    </form>

    <!-- 리스트 테이블 -->
    <table>
        <thead>
            <tr>
                <th>번호</th>
                <th>제목</th>
                <th>내용</th>
                <th>작성일</th>
            </tr>
        </thead>
        <tbody>
            <tr th:if="${response?.content == null || response.content.isEmpty()}">
                <td colspan="4">검색된 학습 글이 존재하지 않습니다.</td>
            </tr>
            <tr th:each="post : ${response?.content}">
                <td th:text="${post.id}"></td>
                <td th:text="${post.title}"></td>
                <td th:text="${post.content}"></td>
                <td th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd')}"></td>
            </tr>
        </tbody>
    </table>

    <!-- 페이징 -->
    <div th:if="${response != null && !response.content.isEmpty()}" 
         th:with="p=${paging}">
        <!-- 처음/이전 -->
        <a th:if="${!p.first}" th:href="${p.getPageUrl(1)}">처음</a>
        <a th:if="${!p.first}" th:href="${p.getPageUrl(p.currentPage - 1)}">이전</a>

        <!-- 페이지 번호 -->
        <span th:each="pageNum : ${p.pageNumbers}">
            <a th:if="${pageNum != p.currentPage}" 
               th:href="${p.getPageUrl(pageNum)}"
               th:text="${pageNum}"></a>
            <strong th:if="${pageNum == p.currentPage}" 
                    th:text="${pageNum}"></strong>
        </span>

        <!-- 다음/마지막 -->
        <a th:if="${!p.last}" th:href="${p.getPageUrl(p.currentPage + 1)}">다음</a>
        <a th:if="${!p.last}" th:href="${p.getPageUrl(p.totalPages)}">마지막</a>
    </div>
</body>
</html>